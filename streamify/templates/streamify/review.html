{% extends "base.html" %}
{% load static %}
{% load replace_titles %}

{% block children %}
<html>
    <title>Catalogo</title>

    <head>
        <meta charset='utf-8'>
        <meta name='viewport' content='width=device-width, initial-scale=1'>
        <link href='https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css' rel='stylesheet'>
        <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
        <script type='text/javascript' src='https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js'></script>
        
        <style>
        
            ::-webkit-scrollbar {
            width: 8px;
            }

            ::-webkit-scrollbar-track {
            background: #f1f1f1; 
            }
            
            ::-webkit-scrollbar-thumb {
            background: #888; 
            }
            
            ::-webkit-scrollbar-thumb:hover {
            background: #555; 
            } #      

            *{
                margin: 0;
                padding: 0;
                box-sizing: border-box;
                font-family: 'poppins', sans-serif;
            } 
            
            .button_link{
                text-decoration: none;
                display: inline-block;
                position: relative;
                padding: 15px 15px;
                text-transform: uppercase;
                color: #ddd;
                background: #1C2833;
                font-size: 10px;
                margin: 8px;
                letter-spacing: 0.7em;
                border-radius: 15px;
            }

            .button_link p{
                position: absolute;
                display: block;
                background: #FF5722;
            }

            .button_link p:nth-child(1){
                left: 0;
                bottom: 0;
                width: 100%;
                height: 2px;
                transform: scaleX(0);
                transform-origin: right;
                transition: transform 0.1s;
            }

            .button_link:hover p:nth-child(1){
                transform: scaleX(1);
                transform-origin: left;
                transition: transform 0.1s;
            }
            
            .button_link p:nth-child(2){
                right: 0;
                bottom: 0;
                width: 2px;
                height: 100%;
                transform: scaleY(0);
                transform-origin: top;
                transition: transform 0.1s;
            }

            .button_link:hover p:nth-child(2){
                transform: scaleY(1);
                transform-origin: bottom;
                transition: transform 0.1s;
                transition-delay: 0.1s;
            }
            
            .button_link p:nth-child(3){
                top: 0;
                right: 0;
                width: 100%;
                height: 2px;
                transform: scaleX(0);
                transform-origin: left;
                transition: transform 0.1s;
            }

            .button_link:hover p:nth-child(3){
                transform: scaleX(1);
                transform-origin: right;
                transition: transform 0.1s;
                transition-delay: 0.1s;
            }
            
            .button_link p:nth-child(4){
                top: 0;
                left: 0;
                width: 2px;
                height: 100%;
                transform: scaleY(0);
                transform-origin: bottom;
            }

            .button_link:hover p:nth-child(4){
                transform: scaleY(1);
                transform-origin: top;
                transition: transform 0.1s;
                transition-delay: 0.1s;
            }

            .button_link:hover{
                transition: 0.7s;
                transition-delay: 0.1s;
                background: #FF5722;
            }

            .starpng {
                width: 5%;
            }
            
            .starpng:hover {
                cursor: pointer;
            }

        </style>

        <center> <h1> Recensioni di {{film.titolo}} </h1> </center>
    </head>
    
    <body className='snippet-body'>
        <div class="min-h-screen bg-cyan-700 py-5">
            <div class='overflow-x-auto w-full'>
                <table class='mx-auto max-w-4xl w-full whitespace-nowrap rounded-lg bg-white divide-y divide-gray-300 overflow-hidden'>
                    <thead class="bg-gray-900">
                        <tr class="text-white text-center">
                            <th class="font-semibold text-sm uppercase px-6 py-4"> Titolo film </th>
                            <th class="font-semibold text-sm uppercase px-6 py-4"> Autore recensione </th>
                            <th class="font-semibold text-sm uppercase px-6 py-4"> Voto recensione </th>
                            <th class="font-semibold text-sm uppercase px-6 py-4 text-center"> Commento </th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                        {% for recensione in lista_recensioni %}
                        <tr>
                            <td class="px-6 py-4">
                                <center><div class="flex items-center space-x-3">
                                    <div>
                                        <p>
                                            <a href="/streamify/descr_film/{{film.titolo}}">
                                                {{recensione.film.titolo | replace_titles}}
                                            </a> 
                                        </p>
                                    </div> </center>
                                </div>
                            </td>

                            <td class="px-6 py-4">
                                <center>
                                    {{recensione.utente.username}}
                                </center>
                            </td>

                            <td class="px-6 py-4 text-center">
                                <center>
                                    {% if recensione.voto <= 2.9 %}
                                            <p style="background-color: red; width: 10%;"> {{recensione.voto}} </p>
                                        
                                    {% elif recensione.voto >= 3.0 and recensione.voto < 4.0 %}
                                        <p style="background-color: yellow; width: 10%;"> {{recensione.voto}} </p>
                                
                                    {% elif recensione.voto >= 4.0 %}
                                            <p style="background-color: green; width: 10%;"> {{recensione.voto}} </p>
                                    {% endif %}
                                </center>
                            </td>

                            <td class="px-6 py-4">
                                <center> <p class="text-gray-500 text-sm font-semibold tracking-wide">
                                    {{recensione.commento_scritto}}
                                </p> </center>
                            </td>
                        </tr>
                        <tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <br><br>
            <center>
                <p class="welcome"> Lascia una recensione a {{film.titolo | replace_titles}} </p>
        
                <img class="starpng" src="{% static "imgs/star.png" %}" value="1" alt="Image" onclick="rate(this)">
                <img class="starpng" src="{% static "imgs/star.png" %}" value="2" alt="Image" onclick="rate(this)">
                <img class="starpng" src="{% static "imgs/star.png" %}" value="3" alt="Image" onclick="rate(this)">
                <img class="starpng" src="{% static "imgs/star.png" %}" value="4" alt="Image" onclick="rate(this)">
                <img class="starpng" src="{% static "imgs/star.png" %}" value="5" alt="Image" onclick="rate(this)">
                
                <form action="/streamify/review_final/" method="POST">
                    {% csrf_token %}
                    <input type="text" class="commento_scritto" name="commento_scritto" size="50"> 
                    <input type="hidden" value="" name="selected_star" id="result_data_js">
                    <input class="vota_button" type="submit" value="Vota">
                </form>
            </center>

        </div>

    </body>
</html>
{% endblock %}